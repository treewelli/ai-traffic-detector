2025-05-08 21:06:56,468 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-08 21:06:56,468 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-08 21:06:56,468 - INFO - 训练模式: manual
2025-05-08 21:06:56,469 - INFO - 训练设备: cuda
2025-05-08 21:06:56,469 - INFO - 启用 AMP 混合精度: False
2025-05-08 21:19:51,072 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-08 21:19:51,073 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-08 21:19:51,073 - INFO - 训练模式: manual
2025-05-08 21:19:51,074 - INFO - 训练设备: cuda
2025-05-08 21:19:51,074 - INFO - 启用 AMP 混合精度: False
2025-05-08 22:00:13,937 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-08 22:00:13,937 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-08 22:00:13,937 - INFO - 训练模式: manual
2025-05-08 22:00:13,937 - INFO - 训练设备: cuda
2025-05-08 22:00:13,937 - INFO - 启用 AMP 混合精度: False
2025-05-08 22:00:14,024 - WARNING - ⚠️ 当前样本中缺失类别：{np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14)}，将其权重设为0
2025-05-08 22:00:14,526 - INFO - 类别权重: [0.4293006956577301, 17.712421417236328, 1.3874952793121338, 1.1192573308944702, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
2025-05-08 22:00:15,668 - INFO - 是否使用 cuDNN: True, 模型 device: cuda:0
2025-05-08 22:00:54,998 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-08 22:02:22,117 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-08 22:02:22,117 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-08 22:02:22,117 - INFO - 训练模式: manual
2025-05-08 22:02:22,117 - INFO - 训练设备: cuda
2025-05-08 22:02:22,117 - INFO - 启用 AMP 混合精度: False
2025-05-08 22:02:22,131 - WARNING - ⚠️ 当前样本中缺失类别：{np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14)}，将其权重设为0
2025-05-08 22:02:22,527 - INFO - 类别权重: [0.4293006956577301, 17.712421417236328, 1.3874952793121338, 1.1192573308944702, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
2025-05-08 22:02:23,114 - INFO - 是否使用 cuDNN: True, 模型 device: cuda:0
2025-05-08 22:03:01,528 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-08 22:07:39,484 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-08 22:07:39,484 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-08 22:07:39,485 - INFO - 训练模式: manual
2025-05-08 22:07:39,485 - INFO - 训练设备: cuda
2025-05-08 22:07:39,485 - INFO - 启用 AMP 混合精度: False
2025-05-08 22:07:39,505 - WARNING - ⚠️ 当前样本中缺失类别：{np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14)}，将其权重设为0
2025-05-08 22:07:39,890 - INFO - 类别权重: [0.4293006956577301, 17.712421417236328, 1.3874952793121338, 1.1192573308944702, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
2025-05-08 22:07:40,965 - INFO - 是否使用 cuDNN: True, 模型 device: cuda:0
2025-05-08 22:08:40,488 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-08 22:16:49,628 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-08 22:16:49,628 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-08 22:16:49,628 - INFO - 训练模式: manual
2025-05-08 22:16:49,629 - INFO - 训练设备: cuda
2025-05-08 22:16:49,629 - INFO - 启用 AMP 混合精度: False
2025-05-08 22:18:28,892 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-08 22:18:28,893 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-08 22:18:28,893 - INFO - 训练模式: manual
2025-05-08 22:18:28,893 - INFO - 训练设备: cuda
2025-05-08 22:18:28,893 - INFO - 启用 AMP 混合精度: False
2025-05-08 22:18:28,906 - WARNING - ⚠️ 当前样本中缺失类别：{np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14)}，将其权重设为0
2025-05-08 22:18:29,248 - INFO - 类别权重: [0.4293006956577301, 17.712421417236328, 1.3874952793121338, 1.1192573308944702, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
2025-05-08 22:18:30,199 - INFO - 是否使用 cuDNN: True, 模型 device: cuda:0
2025-05-08 22:18:30,271 - INFO - [DEBUG] 输入 shape: torch.Size([1, 2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-08 22:20:26,983 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-08 22:20:26,983 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-08 22:20:26,983 - INFO - 训练模式: manual
2025-05-08 22:20:26,983 - INFO - 训练设备: cuda
2025-05-08 22:20:26,983 - INFO - 启用 AMP 混合精度: False
2025-05-08 22:20:26,997 - WARNING - ⚠️ 当前样本中缺失类别：{np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14)}，将其权重设为0
2025-05-08 22:20:27,958 - INFO - 类别权重: [0.4293006956577301, 17.712421417236328, 1.3874952793121338, 1.1192573308944702, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
2025-05-08 22:20:28,488 - INFO - 是否使用 cuDNN: True, 模型 device: cuda:0
2025-05-08 22:20:28,548 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-08 22:21:43,149 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-08 22:21:43,149 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-08 22:21:43,149 - INFO - 训练模式: manual
2025-05-08 22:21:43,149 - INFO - 训练设备: cuda
2025-05-08 22:21:43,149 - INFO - 启用 AMP 混合精度: False
2025-05-08 22:21:43,160 - WARNING - ⚠️ 当前样本中缺失类别：{np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14)}，将其权重设为0
2025-05-08 22:21:43,528 - INFO - 类别权重: [0.4293006956577301, 17.712421417236328, 1.3874952793121338, 1.1192573308944702, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
2025-05-08 22:21:44,091 - INFO - 是否使用 cuDNN: True, 模型 device: cuda:0
2025-05-08 22:21:44,153 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-08 22:23:13,365 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-08 22:23:13,366 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-08 22:23:13,366 - INFO - 训练模式: manual
2025-05-08 22:23:13,366 - INFO - 训练设备: cuda
2025-05-08 22:23:13,366 - INFO - 启用 AMP 混合精度: False
2025-05-08 22:23:13,450 - WARNING - ⚠️ 当前样本中缺失类别：{np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14)}，将其权重设为0
2025-05-08 22:23:13,829 - INFO - 类别权重: [0.4293006956577301, 17.712421417236328, 1.3874952793121338, 1.1192573308944702, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
2025-05-08 22:23:14,495 - INFO - 是否使用 cuDNN: True, 模型 device: cuda:0
2025-05-08 22:23:14,580 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-08 22:24:50,526 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-08 22:24:50,526 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-08 22:24:50,526 - INFO - 训练模式: manual
2025-05-08 22:24:50,527 - INFO - 训练设备: cuda
2025-05-08 22:24:50,527 - INFO - 启用 AMP 混合精度: False
2025-05-08 22:24:50,540 - WARNING - ⚠️ 当前样本中缺失类别：{np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14)}，将其权重设为0
2025-05-08 22:24:50,825 - INFO - 类别权重: [0.4293006956577301, 17.712421417236328, 1.3874952793121338, 1.1192573308944702, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
2025-05-08 22:24:51,383 - INFO - 是否使用 cuDNN: True, 模型 device: cuda:0
2025-05-08 22:24:51,448 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-08 22:28:20,124 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-08 22:28:20,124 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-08 22:28:20,124 - INFO - 训练模式: manual
2025-05-08 22:28:20,125 - INFO - 训练设备: cuda
2025-05-08 22:28:20,125 - INFO - 启用 AMP 混合精度: False
2025-05-08 22:28:20,138 - WARNING - ⚠️ 当前样本中缺失类别：{np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14)}，将其权重设为0
2025-05-08 22:28:20,432 - INFO - 类别权重: [0.4293006956577301, 17.712421417236328, 1.3874952793121338, 1.1192573308944702, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
2025-05-08 22:28:20,984 - INFO - 是否使用 cuDNN: True, 模型 device: cuda:0
2025-05-08 22:28:21,056 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-08 22:36:46,192 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-08 22:36:46,193 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-08 22:36:46,193 - INFO - 训练模式: manual
2025-05-08 22:36:46,193 - INFO - 训练设备: cuda
2025-05-08 22:36:46,193 - INFO - 启用 AMP 混合精度: False
2025-05-08 22:36:46,274 - WARNING - ⚠️ 当前样本中缺失类别：{np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14)}，将其权重设为0
2025-05-08 22:36:46,952 - INFO - 类别权重: [0.4293006956577301, 17.712421417236328, 1.3874952793121338, 1.1192573308944702, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
2025-05-08 22:38:33,127 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-08 22:38:33,128 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-08 22:38:33,128 - INFO - 训练模式: manual
2025-05-08 22:38:33,128 - INFO - 训练设备: cuda
2025-05-08 22:38:33,128 - INFO - 启用 AMP 混合精度: False
2025-05-08 22:38:33,206 - WARNING - ⚠️ 当前样本中缺失类别：{np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14)}，将其权重设为0
2025-05-08 22:38:33,654 - INFO - 类别权重: [0.4293006956577301, 17.712421417236328, 1.3874952793121338, 1.1192573308944702, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
2025-05-08 22:38:34,659 - INFO - 是否使用 cuDNN: True, 模型 device: cuda:0
2025-05-08 22:38:34,743 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-08 22:39:21,287 - INFO - 
              precision    recall  f1-score   support

      BENIGN       0.00      0.00      0.00     82837
         Bot       0.00      0.00      0.00      2024
        DDoS       0.00      0.00      0.00     25518
    PortScan       0.22      1.00      0.37     31854

    accuracy                           0.22    142233
   macro avg       0.06      0.25      0.09    142233
weighted avg       0.05      0.22      0.08    142233

2025-05-08 22:39:21,290 - INFO - Epoch 1: Train Loss = 2.1886, Val F1 = 0.0823
2025-05-08 22:39:21,296 - INFO - 保存新最佳模型
2025-05-08 22:39:30,002 - INFO - 已更新滑动平均模型 best.pt
2025-05-08 22:39:30,002 - INFO - 是否使用 cuDNN: True, 模型 device: cuda:0
2025-05-08 22:39:30,068 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-08 22:40:17,512 - INFO - 
              precision    recall  f1-score   support

      BENIGN       0.00      0.00      0.00     82837
         Bot       0.00      0.00      0.00      2024
        DDoS       0.00      0.00      0.00     25518
    PortScan       0.22      1.00      0.37     31854

    accuracy                           0.22    142233
   macro avg       0.06      0.25      0.09    142233
weighted avg       0.05      0.22      0.08    142233

2025-05-08 22:40:17,515 - INFO - Epoch 2: Train Loss = 1.3686, Val F1 = 0.0820
2025-05-08 22:40:26,419 - INFO - 已更新滑动平均模型 best.pt
2025-05-08 22:43:56,919 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-08 22:43:56,920 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-08 22:43:56,920 - INFO - 训练模式: manual
2025-05-08 22:43:56,920 - INFO - 训练设备: cuda
2025-05-08 22:43:56,920 - INFO - 启用 AMP 混合精度: False
2025-05-08 22:43:56,933 - WARNING - ⚠️ 当前样本中缺失类别：{np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14)}，将其权重设为0
2025-05-08 22:43:57,300 - INFO - 类别权重: [0.4293006956577301, 17.712421417236328, 1.3874952793121338, 1.1192573308944702, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
2025-05-08 22:45:40,096 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-08 22:45:40,096 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-08 22:45:40,096 - INFO - 训练模式: manual
2025-05-08 22:45:40,096 - INFO - 训练设备: cuda
2025-05-08 22:45:40,096 - INFO - 启用 AMP 混合精度: False
2025-05-08 22:45:40,109 - WARNING - ⚠️ 当前样本中缺失类别：{np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14)}，将其权重设为0
2025-05-08 22:45:40,478 - INFO - 类别权重: [0.4293006956577301, 17.712421417236328, 1.3874952793121338, 1.1192573308944702, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
2025-05-08 22:45:41,055 - INFO - 训练标签分布: (array([0, 1, 2, 3], dtype=int32), array([331308,   8030, 102509, 127076]))
2025-05-08 22:45:41,055 - INFO - 是否使用 cuDNN: True, 模型 device: cuda:0
2025-05-08 22:45:41,127 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-08 22:47:03,161 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-08 22:47:03,162 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-08 22:47:03,162 - INFO - 训练模式: manual
2025-05-08 22:47:03,162 - INFO - 训练设备: cuda
2025-05-08 22:47:03,162 - INFO - 启用 AMP 混合精度: False
2025-05-08 22:47:03,175 - WARNING - ⚠️ 当前样本中缺失类别：{np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14)}，将其权重设为0
2025-05-08 22:47:03,464 - INFO - 类别权重: [0.4293006956577301, 17.712421417236328, 1.3874952793121338, 1.1192573308944702, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
2025-05-08 22:47:04,005 - INFO - 训练标签分布: (array([0, 1, 2, 3], dtype=int32), array([331308,   8030, 102509, 127076]))
2025-05-08 22:47:04,005 - INFO - 是否使用 cuDNN: True, 模型 device: cuda:0
2025-05-08 22:47:04,084 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-08 22:47:51,381 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-08 22:47:51,381 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-08 22:47:51,382 - INFO - 训练模式: manual
2025-05-08 22:47:51,382 - INFO - 训练设备: cuda
2025-05-08 22:47:51,382 - INFO - 启用 AMP 混合精度: True
2025-05-08 22:47:51,395 - WARNING - ⚠️ 当前样本中缺失类别：{np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14)}，将其权重设为0
2025-05-08 22:47:51,692 - INFO - 类别权重: [0.4293006956577301, 17.712421417236328, 1.3874952793121338, 1.1192573308944702, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
2025-05-08 22:47:52,255 - INFO - 训练标签分布: (array([0, 1, 2, 3], dtype=int32), array([331308,   8030, 102509, 127076]))
2025-05-08 22:47:52,255 - INFO - 是否使用 cuDNN: True, 模型 device: cuda:0
2025-05-08 22:47:52,332 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-08 22:48:10,281 - INFO - 
              precision    recall  f1-score   support

      BENIGN       1.00      0.01      0.03     82837
         Bot       0.00      0.00      0.00      2024
        DDoS       0.00      0.00      0.00     25518
    PortScan       0.23      1.00      0.37     31854

    accuracy                           0.23    142233
   macro avg       0.31      0.25      0.10    142233
weighted avg       0.63      0.23      0.10    142233

2025-05-08 22:48:10,284 - INFO - Epoch 1: Train Loss = 2.1542, Val F1 = 0.0993
2025-05-08 22:48:10,290 - INFO - 保存新最佳模型
2025-05-08 22:48:18,910 - INFO - 已更新滑动平均模型 best.pt
2025-05-08 22:48:18,911 - INFO - 是否使用 cuDNN: True, 模型 device: cuda:0
2025-05-08 22:48:18,974 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-08 23:00:42,931 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-08 23:00:42,932 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-08 23:00:42,932 - INFO - 训练模式: manual
2025-05-08 23:00:42,932 - INFO - 训练设备: cuda
2025-05-08 23:00:42,932 - INFO - 启用 AMP 混合精度: True
2025-05-08 23:00:43,013 - INFO - ⚙️ 动态设置 num_classes = 4
2025-05-08 23:00:44,101 - INFO - 类别权重: [0.4293006956577301, 17.712421417236328, 1.3874952793121338, 1.1192573308944702]
2025-05-08 23:00:44,101 - INFO - 类别权重: [0.4293006956577301, 17.712421417236328, 1.3874952793121338, 1.1192573308944702]
2025-05-08 23:00:45,139 - INFO - 训练标签分布: (array([0, 1, 2, 3], dtype=int32), array([331308,   8030, 102509, 127076]))
2025-05-08 23:00:45,139 - INFO - 是否使用 cuDNN: True, 模型 device: cuda:0
2025-05-08 23:00:45,226 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-08 23:01:02,703 - INFO - 
              precision    recall  f1-score   support

      BENIGN       0.98      0.04      0.08     82837
         Bot       0.02      1.00      0.03      2024
        DDoS       0.00      0.00      0.00     25518
    PortScan       0.00      0.00      0.00     31854

    accuracy                           0.04    142233
   macro avg       0.25      0.26      0.03    142233
weighted avg       0.57      0.04      0.05    142233

2025-05-08 23:01:02,706 - INFO - Epoch 1: Train Loss = 0.8527, Val F1 = 0.0497
2025-05-08 23:01:02,711 - INFO - 保存新最佳模型
2025-05-08 23:01:11,255 - INFO - 已更新滑动平均模型 best.pt
2025-05-08 23:01:11,256 - INFO - 是否使用 cuDNN: True, 模型 device: cuda:0
2025-05-08 23:01:11,318 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-08 23:01:28,481 - INFO - 
              precision    recall  f1-score   support

      BENIGN       0.00      0.00      0.00     82837
         Bot       0.02      0.99      0.04      2024
        DDoS       0.00      0.00      0.00     25518
    PortScan       0.37      0.50      0.43     31854

    accuracy                           0.13    142233
   macro avg       0.10      0.37      0.12    142233
weighted avg       0.08      0.13      0.10    142233

2025-05-08 23:01:28,484 - INFO - Epoch 2: Train Loss = 0.9801, Val F1 = 0.0961
2025-05-08 23:01:28,488 - INFO - 保存新最佳模型
2025-05-08 23:01:37,215 - INFO - 已更新滑动平均模型 best.pt
2025-05-08 23:09:38,958 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-08 23:09:38,959 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-08 23:09:38,960 - INFO - 训练模式: manual
2025-05-08 23:09:38,960 - INFO - 训练设备: cuda
2025-05-08 23:09:38,960 - INFO - 启用 AMP 混合精度: True
2025-05-08 23:09:39,017 - INFO - ⚙️ 动态设置 num_classes = 4
2025-05-08 23:09:39,191 - INFO - 类别权重: [0.43604177236557007, 8.515473365783691, 1.4092909097671509, 1.1368393898010254]
2025-05-08 23:09:39,191 - INFO - 类别权重: [0.43604177236557007, 8.515473365783691, 1.4092909097671509, 1.1368393898010254]
2025-05-08 23:09:40,269 - INFO - 训练标签分布: (array([0, 1, 2, 3], dtype=int32), array([331310,  16965, 102509, 127076]))
2025-05-08 23:09:40,270 - INFO - 是否使用 cuDNN: True, 模型 device: cuda:0
2025-05-08 23:09:40,373 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-08 23:09:58,611 - INFO - 
              precision    recall  f1-score   support

      BENIGN       0.81      0.08      0.15     82835
         Bot       0.03      1.00      0.07      4260
        DDoS       0.00      0.00      0.00     25518
    PortScan       0.00      0.00      0.00     31854

    accuracy                           0.08    144467
   macro avg       0.21      0.27      0.05    144467
weighted avg       0.47      0.08      0.09    144467

2025-05-08 23:09:58,615 - INFO - Epoch 1: Train Loss = 0.7913, Val F1 = 0.0880
2025-05-08 23:09:58,622 - INFO - 保存新最佳模型
2025-05-08 23:10:07,317 - INFO - 已更新滑动平均模型 best.pt
2025-05-08 23:10:07,328 - INFO - 是否使用 cuDNN: True, 模型 device: cuda:0
2025-05-08 23:10:07,396 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-08 23:10:25,855 - INFO - 
              precision    recall  f1-score   support

      BENIGN       0.14      0.00      0.00     82835
         Bot       0.05      1.00      0.09      4260
        DDoS       0.00      0.00      0.00     25518
    PortScan       0.54      0.93      0.68     31854

    accuracy                           0.24    144467
   macro avg       0.18      0.48      0.19    144467
weighted avg       0.20      0.24      0.15    144467

2025-05-08 23:10:25,867 - INFO - Epoch 2: Train Loss = 0.6645, Val F1 = 0.1544
2025-05-08 23:10:25,871 - INFO - 保存新最佳模型
2025-05-08 23:10:34,739 - INFO - 已更新滑动平均模型 best.pt
2025-05-08 23:26:43,185 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-08 23:26:43,187 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-08 23:26:43,187 - INFO - 训练模式: manual
2025-05-08 23:26:43,187 - INFO - 训练设备: cuda
2025-05-08 23:26:43,187 - INFO - 启用 AMP 混合精度: True
2025-05-08 23:26:43,231 - INFO - ⚙️ 动态设置 num_classes = 4
2025-05-08 23:26:43,440 - INFO - 类别权重: [0.43604177236557007, 8.515473365783691, 1.4092909097671509, 1.1368393898010254]
2025-05-08 23:26:43,440 - INFO - 类别权重: [0.43604177236557007, 8.515473365783691, 1.4092909097671509, 1.1368393898010254]
2025-05-08 23:26:44,499 - INFO - 训练标签分布: (array([0, 1, 2, 3], dtype=int32), array([331310,  16965, 102509, 127076]))
2025-05-08 23:26:44,602 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-08 23:27:03,513 - INFO - 
              precision    recall  f1-score   support

      BENIGN       0.61      0.18      0.28     82835
         Bot       0.04      1.00      0.07      4260
        DDoS       0.00      0.00      0.00     25518
    PortScan       0.00      0.00      0.00     31854

    accuracy                           0.13    144467
   macro avg       0.16      0.29      0.09    144467
weighted avg       0.35      0.13      0.16    144467

2025-05-08 23:27:03,516 - INFO - Epoch 1: Train Loss = 0.7560, Val F1 = 0.1603
2025-05-08 23:27:03,522 - INFO - 保存新最佳模型
2025-05-08 23:27:12,488 - INFO - 已更新滑动平均模型 best.pt
2025-05-08 23:27:12,557 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-08 23:27:30,256 - INFO - 
              precision    recall  f1-score   support

      BENIGN       0.77      0.99      0.87     82835
         Bot       0.00      0.00      0.00      4260
        DDoS       0.00      0.00      0.00     25518
    PortScan       0.79      0.95      0.86     31854

    accuracy                           0.78    144467
   macro avg       0.39      0.49      0.43    144467
weighted avg       0.62      0.78      0.69    144467

2025-05-08 23:27:30,263 - INFO - Epoch 2: Train Loss = 0.8052, Val F1 = 0.6888
2025-05-08 23:27:30,269 - INFO - 保存新最佳模型
2025-05-08 23:27:39,130 - INFO - 已更新滑动平均模型 best.pt
2025-05-08 23:36:02,004 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-08 23:36:02,006 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-08 23:36:02,006 - INFO - 训练模式: manual
2025-05-08 23:36:02,006 - INFO - 训练设备: cuda
2025-05-08 23:36:02,006 - INFO - 启用 AMP 混合精度: True
2025-05-08 23:36:02,051 - INFO - ⚙️ 动态设置 num_classes = 4
2025-05-08 23:36:02,229 - INFO - 类别权重: [0.43604177236557007, 8.515473365783691, 1.4092909097671509, 1.1368393898010254]
2025-05-08 23:36:02,230 - INFO - 类别权重: [0.43604177236557007, 8.515473365783691, 1.4092909097671509, 1.1368393898010254]
2025-05-08 23:36:03,283 - INFO - 训练标签分布: (array([0, 1, 2, 3], dtype=int32), array([331310,  16965, 102509, 127076]))
2025-05-08 23:36:03,365 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-08 23:36:22,278 - INFO - 
              precision    recall  f1-score   support

      BENIGN       0.12      0.03      0.04     82835
         Bot       0.03      1.00      0.06      4260
        DDoS       0.00      0.00      0.00     25518
    PortScan       0.00      0.00      0.00     31854

    accuracy                           0.04    144467
   macro avg       0.04      0.26      0.03    144467
weighted avg       0.07      0.04      0.03    144467

2025-05-08 23:36:22,282 - INFO - Epoch 1: Train Loss = 0.7916, Val F1 = 0.0258
2025-05-08 23:36:22,288 - INFO - 保存新最佳模型
2025-05-08 23:36:32,332 - INFO - 已更新滑动平均模型 best.pt
2025-05-08 23:36:32,411 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-08 23:36:50,320 - INFO - 
              precision    recall  f1-score   support

      BENIGN       0.41      0.00      0.00     82835
         Bot       0.05      1.00      0.09      4260
        DDoS       0.00      0.00      0.00     25518
    PortScan       0.54      0.96      0.69     31854

    accuracy                           0.24    144467
   macro avg       0.25      0.49      0.20    144467
weighted avg       0.36      0.24      0.16    144467

2025-05-08 23:36:50,329 - INFO - Epoch 2: Train Loss = 0.5558, Val F1 = 0.1563
2025-05-08 23:36:50,333 - INFO - 保存新最佳模型
2025-05-08 23:36:59,190 - INFO - 已更新滑动平均模型 best.pt
2025-05-08 23:52:48,260 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-08 23:52:48,262 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-08 23:52:48,262 - INFO - 训练模式: manual
2025-05-08 23:52:48,262 - INFO - 训练设备: cuda
2025-05-08 23:52:48,262 - INFO - 启用 AMP 混合精度: True
2025-05-08 23:52:48,294 - INFO - ⚙️ 动态设置 num_classes = 4
2025-05-08 23:52:48,416 - INFO - 类别权重: [0.42929166555404663, 17.683408737182617, 1.3886836767196655, 1.1186623573303223]
2025-05-08 23:52:48,416 - INFO - 类别权重: [0.42929166555404663, 17.683408737182617, 1.3886836767196655, 1.1186623573303223]
2025-05-08 23:52:49,436 - INFO - 训练标签分布: (array([0, 1, 2, 3], dtype=int32), array([414145,  10054, 128027, 158930]))
2025-05-08 23:52:49,505 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-08 23:53:10,316 - INFO - 
              precision    recall  f1-score   support

      BENIGN       0.58      1.00      0.74     82591
         Bot       0.00      0.00      0.00      1961
        DDoS       0.00      0.00      0.00     25557
    PortScan       0.00      0.00      0.00     31599

    accuracy                           0.58    141708
   macro avg       0.15      0.25      0.18    141708
weighted avg       0.34      0.58      0.43    141708

2025-05-08 23:53:10,318 - INFO - Epoch 1: Train Loss = 1.1383, Val F1 = 0.4292
2025-05-08 23:53:10,323 - INFO - 保存新最佳模型
2025-05-08 23:53:14,531 - WARNING - 跳过 EMA 更新：预测类别不足
2025-05-08 23:53:14,577 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-08 23:53:34,867 - INFO - 
              precision    recall  f1-score   support

      BENIGN       0.73      1.00      0.84     82591
         Bot       0.00      0.00      0.00      1961
        DDoS       0.00      0.00      0.00     25557
    PortScan       0.44      0.41      0.42     31599

    accuracy                           0.67    141708
   macro avg       0.29      0.35      0.32    141708
weighted avg       0.52      0.67      0.59    141708

2025-05-08 23:53:34,870 - INFO - Epoch 2: Train Loss = 1.2295, Val F1 = 0.5865
2025-05-08 23:53:34,875 - INFO - 保存新最佳模型
2025-05-08 23:53:43,508 - INFO - 已更新滑动平均模型 best.pt
2025-05-09 00:08:41,871 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-09 00:08:41,873 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-09 00:08:41,873 - INFO - 训练模式: manual
2025-05-09 00:08:41,873 - INFO - 训练设备: cuda
2025-05-09 00:08:41,873 - INFO - 启用 AMP 混合精度: True
2025-05-09 00:08:41,884 - INFO - ⚙️ 动态设置 num_classes = 4
2025-05-09 00:08:42,001 - INFO - 类别权重: [0.42929166555404663, 17.683408737182617, 1.3886836767196655, 1.1186623573303223]
2025-05-09 00:08:42,002 - INFO - 类别权重: [0.42929166555404663, 17.683408737182617, 1.3886836767196655, 1.1186623573303223]
2025-05-09 00:08:43,038 - INFO - 训练标签分布: (array([0, 1, 2, 3], dtype=int32), array([414145,  10054, 128027, 158930]))
2025-05-09 00:08:43,105 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-09 00:09:00,032 - INFO - 
              precision    recall  f1-score   support

      BENIGN       0.25      1.00      0.40      1000
         Bot       0.00      0.00      0.00      1000
        DDoS       0.00      0.00      0.00      1000
    PortScan       0.00      0.00      0.00      1000

    accuracy                           0.25      4000
   macro avg       0.06      0.25      0.10      4000
weighted avg       0.06      0.25      0.10      4000

2025-05-09 00:09:00,032 - INFO - Epoch 1: Train Loss = 1.1469, Val F1 = 0.1000
2025-05-09 00:09:00,036 - INFO - 保存新最佳模型
2025-05-09 00:09:00,219 - WARNING - 跳过 EMA 更新：预测类别不足
2025-05-09 00:09:00,262 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-09 00:09:16,482 - INFO - 
              precision    recall  f1-score   support

      BENIGN       0.25      1.00      0.40      1000
         Bot       0.00      0.00      0.00      1000
        DDoS       0.00      0.00      0.00      1000
    PortScan       0.91      0.02      0.04      1000

    accuracy                           0.26      4000
   macro avg       0.29      0.26      0.11      4000
weighted avg       0.29      0.26      0.11      4000

2025-05-09 00:09:16,482 - INFO - Epoch 2: Train Loss = 0.9675, Val F1 = 0.1107
2025-05-09 00:09:16,486 - INFO - 保存新最佳模型
2025-05-09 00:09:16,854 - INFO - 已更新滑动平均模型 best.pt
2025-05-09 00:20:03,872 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-09 00:20:03,872 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-09 00:20:03,873 - INFO - 训练模式: manual
2025-05-09 00:20:03,873 - INFO - 训练设备: cuda
2025-05-09 00:20:03,873 - INFO - 启用 AMP 混合精度: True
2025-05-09 00:20:03,888 - INFO - ⚙️ 动态设置 num_classes = 4
2025-05-09 00:20:03,977 - INFO - 类别权重: [0.42929166555404663, 17.683408737182617, 1.3886836767196655, 1.1186623573303223]
2025-05-09 00:20:03,977 - INFO - 类别权重: [0.42929166555404663, 17.683408737182617, 1.3886836767196655, 1.1186623573303223]
2025-05-09 00:20:04,510 - INFO - 训练标签分布: (array([0, 1, 2, 3], dtype=int32), array([414145,  10054, 128027, 158930]))
2025-05-09 00:20:04,575 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-09 00:20:25,566 - INFO - 
              precision    recall  f1-score   support

      BENIGN       0.58      1.00      0.74     82806
         Bot       0.00      0.00      0.00      1917
        DDoS       0.00      0.00      0.00     25636
    PortScan       0.00      0.00      0.00     31778

    accuracy                           0.58    142137
   macro avg       0.15      0.25      0.18    142137
weighted avg       0.34      0.58      0.43    142137

2025-05-09 00:20:25,568 - INFO - Epoch 1: Train Loss = 1.0652, Val F1 = 0.4289
2025-05-09 00:20:25,573 - INFO - 保存新最佳模型
2025-05-09 00:20:29,863 - WARNING - 跳过 EMA 更新：预测类别不足
2025-05-09 00:20:29,905 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-09 00:20:50,836 - INFO - 
              precision    recall  f1-score   support

      BENIGN       0.58      1.00      0.74     82806
         Bot       0.00      0.00      0.00      1917
        DDoS       0.00      0.00      0.00     25636
    PortScan       0.00      0.00      0.00     31778

    accuracy                           0.58    142137
   macro avg       0.15      0.25      0.18    142137
weighted avg       0.34      0.58      0.43    142137

2025-05-09 00:20:50,838 - INFO - Epoch 2: Train Loss = 1.1659, Val F1 = 0.4289
2025-05-09 00:20:55,191 - WARNING - 跳过 EMA 更新：预测类别不足
2025-05-10 22:31:24,029 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-10 22:31:24,030 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-10 22:31:24,030 - INFO - 训练模式: manual
2025-05-10 22:31:24,030 - INFO - 训练设备: cuda
2025-05-10 22:31:24,031 - INFO - 启用 AMP 混合精度: True
2025-05-10 22:31:24,056 - INFO - ⚙️ 动态设置 num_classes = 4
2025-05-10 22:31:24,216 - INFO - 类别权重: [0.42929166555404663, 17.683408737182617, 1.3886836767196655, 1.1186623573303223]
2025-05-10 22:31:25,445 - INFO - 训练标签分布: (array([0, 1, 2, 3], dtype=int32), array([414145,  10054, 128027, 158930]))
2025-05-10 22:31:25,527 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-10 22:31:47,606 - INFO - 
              precision    recall  f1-score   support

      BENIGN       0.93      1.00      0.96    132187
         Bot       0.00      0.00      0.00     10044

    accuracy                           0.93    142231
   macro avg       0.46      0.50      0.48    142231
weighted avg       0.86      0.93      0.90    142231

2025-05-10 22:31:47,609 - INFO - Epoch 1: Train Loss = 1.3261, Val F1 = 0.8954
2025-05-10 22:31:47,615 - INFO - 保存新最佳模型
2025-05-10 22:31:52,233 - WARNING - 跳过 EMA 更新：预测类别不足
2025-05-10 22:31:52,280 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-10 22:42:00,823 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-10 22:42:00,823 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-10 22:42:00,823 - INFO - 训练模式: manual
2025-05-10 22:42:00,823 - INFO - 训练设备: cuda
2025-05-10 22:42:00,823 - INFO - 启用 AMP 混合精度: True
2025-05-10 22:42:00,839 - INFO - ⚙️ 动态设置 num_classes = 4
2025-05-10 22:42:01,184 - INFO - 类别权重: [0.42929166555404663, 17.683408737182617, 1.3886836767196655, 1.1186623573303223]
2025-05-10 22:42:01,787 - INFO - 训练标签分布: (array([0, 1, 2, 3], dtype=int32), array([414145,  10054, 128027, 158930]))
2025-05-10 22:42:01,848 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-10 22:42:21,654 - INFO - 
              precision    recall  f1-score   support

      BENIGN       0.93      1.00      0.96    132187
         Bot       0.00      0.00      0.00     10044
        DDoS       0.00      0.00      0.00         0
    PortScan       0.00      0.00      0.00         0

    accuracy                           0.93    142231
   macro avg       0.23      0.25      0.24    142231
weighted avg       0.86      0.93      0.90    142231

2025-05-10 22:42:21,656 - INFO - Epoch 1: Train Loss = 1.0631, Val F1 = 0.8954
2025-05-10 22:42:21,663 - INFO - 保存新最佳模型
2025-05-10 22:42:26,221 - WARNING - 跳过 EMA 更新：预测类别不足
2025-05-10 22:42:26,273 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-10 22:42:48,238 - INFO - 
              precision    recall  f1-score   support

      BENIGN       0.92      0.90      0.91    132187
         Bot       0.01      0.01      0.01     10044
        DDoS       0.00      0.00      0.00         0
    PortScan       0.00      0.00      0.00         0

    accuracy                           0.84    142231
   macro avg       0.23      0.23      0.23    142231
weighted avg       0.86      0.84      0.85    142231

2025-05-10 22:42:48,242 - INFO - Epoch 2: Train Loss = 1.1879, Val F1 = 0.8477
2025-05-10 22:42:52,837 - WARNING - 跳过 EMA 更新：预测类别不足
2025-05-10 23:06:02,847 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-10 23:06:02,847 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-10 23:06:02,847 - INFO - 训练模式: manual
2025-05-10 23:06:02,848 - INFO - 训练设备: cuda
2025-05-10 23:06:02,848 - INFO - 启用 AMP 混合精度: True
2025-05-10 23:06:02,861 - INFO - ⚙️ 动态设置 num_classes = 4
2025-05-10 23:06:02,991 - INFO - 类别权重: [0.42929166555404663, 17.683408737182617, 1.3886836767196655, 1.1186623573303223]
2025-05-10 23:06:04,191 - INFO - 训练标签分布: (array([0, 1, 2, 3], dtype=int32), array([414145,  10054, 128027, 158930]))
2025-05-10 23:06:04,321 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-10 23:06:26,755 - INFO - 
              precision    recall  f1-score   support

      BENIGN       0.93      1.00      0.96    132187
         Bot       0.00      0.00      0.00     10044
        DDoS       0.00      0.00      0.00        10
    PortScan       0.00      0.00      0.00        10

    accuracy                           0.93    142251
   macro avg       0.23      0.25      0.24    142251
weighted avg       0.86      0.93      0.90    142251

2025-05-10 23:06:26,758 - INFO - Epoch 1: Train Loss = 1.1417, Val F1 = 0.8952
2025-05-10 23:06:26,764 - INFO - 保存新最佳模型
2025-05-10 23:06:31,347 - WARNING - 跳过 EMA 更新：预测类别不足
2025-05-10 23:06:31,393 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-10 23:06:50,706 - INFO - 
              precision    recall  f1-score   support

      BENIGN       0.93      1.00      0.96    132187
         Bot       0.00      0.00      0.00     10044
        DDoS       0.00      0.00      0.00        10
    PortScan       0.00      0.00      0.00        10

    accuracy                           0.93    142251
   macro avg       0.23      0.25      0.24    142251
weighted avg       0.86      0.93      0.90    142251

2025-05-10 23:06:50,709 - INFO - Epoch 2: Train Loss = 0.9092, Val F1 = 0.8952
2025-05-10 23:06:55,305 - WARNING - 跳过 EMA 更新：预测类别不足
2025-05-10 23:27:49,516 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-10 23:27:49,517 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-10 23:27:49,517 - INFO - 训练模式: manual
2025-05-10 23:27:49,517 - INFO - 训练设备: cuda
2025-05-10 23:27:49,517 - INFO - 启用 AMP 混合精度: True
2025-05-10 23:27:49,529 - INFO - ⚙️ 动态设置 num_classes = 4
2025-05-10 23:27:49,635 - INFO - 类别权重: [0.42929166555404663, 17.683408737182617, 1.3886836767196655, 1.1186623573303223]
2025-05-10 23:27:50,783 - INFO - 训练标签分布: (array([0, 1, 2, 3], dtype=int32), array([414145,  10054, 128027, 158930]))
2025-05-10 23:27:50,869 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-10 23:28:10,671 - INFO - 
              precision    recall  f1-score   support

      BENIGN       0.93      1.00      0.96    132187
         Bot       0.00      0.00      0.00     10044
        DDoS       0.00      0.00      0.00       200
    PortScan       0.00      0.00      0.00       200

    accuracy                           0.93    142631
   macro avg       0.23      0.25      0.24    142631
weighted avg       0.86      0.93      0.89    142631

2025-05-10 23:28:10,673 - INFO - Epoch 1: Train Loss = 1.1462, Val F1 = 0.8916
2025-05-10 23:28:10,679 - INFO - 保存新最佳模型
2025-05-10 23:28:15,286 - WARNING - 跳过 EMA 更新：预测类别不足
2025-05-10 23:28:15,333 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-10 23:28:35,179 - INFO - 
              precision    recall  f1-score   support

      BENIGN       0.77      0.00      0.00    132187
         Bot       0.07      1.00      0.13     10044
        DDoS       0.00      0.00      0.00       200
    PortScan       0.63      0.80      0.71       200

    accuracy                           0.07    142631
   macro avg       0.37      0.45      0.21    142631
weighted avg       0.72      0.07      0.01    142631

2025-05-10 23:28:35,182 - INFO - Epoch 2: Train Loss = 0.9826, Val F1 = 0.0135
2025-05-10 23:28:39,788 - WARNING - 跳过 EMA 更新：预测类别不足
2025-05-10 23:28:56,160 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-10 23:28:56,160 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-10 23:28:56,160 - INFO - 训练模式: manual
2025-05-10 23:28:56,160 - INFO - 训练设备: cuda
2025-05-10 23:28:56,160 - INFO - 启用 AMP 混合精度: True
2025-05-10 23:28:56,175 - INFO - ⚙️ 动态设置 num_classes = 4
2025-05-10 23:28:56,213 - INFO - 类别权重: [0.42929166555404663, 17.683408737182617, 1.3886836767196655, 1.1186623573303223]
2025-05-10 23:28:56,222 - INFO - 训练标签分布: (array([0, 1, 2, 3], dtype=int32), array([414145,  10054, 128027, 158930]))
2025-05-10 23:28:56,278 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-10 23:29:18,771 - INFO - 
              precision    recall  f1-score   support

      BENIGN       0.93      1.00      0.96    132187
         Bot       0.00      0.00      0.00     10044
        DDoS       0.00      0.00      0.00       200
    PortScan       0.00      0.00      0.00       200

    accuracy                           0.93    142631
   macro avg       0.23      0.25      0.24    142631
weighted avg       0.86      0.93      0.89    142631

2025-05-10 23:29:18,774 - INFO - Epoch 1: Train Loss = 1.0319, Val F1 = 0.8916
2025-05-10 23:29:18,779 - INFO - 保存新最佳模型
2025-05-10 23:29:20,922 - WARNING - 跳过 EMA 更新：预测类别不足
2025-05-10 23:29:20,969 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-10 23:29:43,045 - INFO - 
              precision    recall  f1-score   support

      BENIGN       0.93      1.00      0.96    132187
         Bot       0.00      0.00      0.00     10044
        DDoS       0.00      0.00      0.00       200
    PortScan       0.00      0.00      0.00       200

    accuracy                           0.93    142631
   macro avg       0.23      0.25      0.24    142631
weighted avg       0.86      0.93      0.89    142631

2025-05-10 23:29:43,047 - INFO - Epoch 2: Train Loss = 1.0705, Val F1 = 0.8916
2025-05-10 23:29:47,714 - WARNING - 跳过 EMA 更新：预测类别不足
2025-05-10 23:40:39,621 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-10 23:40:39,622 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-10 23:40:39,622 - INFO - 训练模式: manual
2025-05-10 23:40:39,622 - INFO - 训练设备: cuda
2025-05-10 23:40:39,622 - INFO - 启用 AMP 混合精度: True
2025-05-10 23:47:15,651 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-10 23:47:15,652 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-10 23:47:15,652 - INFO - 训练模式: manual
2025-05-10 23:47:15,652 - INFO - 训练设备: cuda
2025-05-10 23:47:15,652 - INFO - 启用 AMP 混合精度: True
2025-05-12 19:04:24,722 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-12 19:04:24,723 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-12 19:04:24,723 - INFO - 训练模式: manual
2025-05-12 19:04:24,723 - INFO - 训练设备: cuda
2025-05-12 19:04:24,723 - INFO - 启用 AMP 混合精度: True
2025-05-12 19:04:24,969 - INFO - ⚙️ 动态设置 num_classes = 15
2025-05-12 19:04:26,405 - INFO - 类别权重: [0.08904721587896347, 20.128400802612305, 1.580689549446106, 1.2733337879180908, 13.323518753051758, 22.570926666259766, 22.570926666259766, 22.570926666259766, 8.623270988464355, 8.623270988464355, 5.5507965087890625, 5.5507965087890625, 0.8757878541946411, 5.5507965087890625, 5.5507965087890625]
2025-05-12 19:04:27,426 - INFO - 训练标签分布: (array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14],
      dtype=int32), array([2272625,   10054,  128027,  158930,   15189,    8966,    8966,
          8966,   23468,   23468,   36458,   36458,  231073,   36458,
         36458]))
2025-05-12 19:04:27,495 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-12 19:05:53,972 - INFO - 
                            precision    recall  f1-score   support

                    BENIGN       0.49      0.18      0.26    369389
                       Bot       0.00      0.00      0.00        10
                      DDoS       0.00      0.00      0.00        10
                  PortScan       0.00      0.00      0.00        10
              Infiltration       0.00      0.00      0.00        10
  Web Attack � Brute Force       0.00      0.00      0.00        10
          Web Attack � XSS       0.00      0.00      0.00        10
Web Attack � Sql Injection       0.00      0.00      0.00        10
               FTP-Patator       0.00      0.00      0.00        10
               SSH-Patator       0.00      0.00      0.00        10
             DoS slowloris       0.00      0.00      0.00     30662
          DoS Slowhttptest       0.00      0.00      0.00     30959
                  DoS Hulk       0.00      0.00      0.00    103186
             DoS GoldenEye       0.08      1.00      0.14     36458
                Heartbleed       0.00      0.00      0.00     36458

                  accuracy                           0.17    607202
                 macro avg       0.04      0.08      0.03    607202
              weighted avg       0.30      0.17      0.17    607202

2025-05-12 19:05:53,981 - INFO - Epoch 1: Train Loss = 2.9291, Val F1 = 0.1680
2025-05-12 19:05:53,984 - INFO - 保存新最佳模型
2025-05-12 19:06:30,781 - INFO - 已更新滑动平均模型 best.pt
2025-05-12 19:06:30,827 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-12 19:07:59,235 - INFO - 
                            precision    recall  f1-score   support

                    BENIGN       0.39      0.00      0.01    369389
                       Bot       0.00      0.00      0.00        10
                      DDoS       0.00      0.00      0.00        10
                  PortScan       0.00      0.00      0.00        10
              Infiltration       0.00      0.00      0.00        10
  Web Attack � Brute Force       0.00      0.00      0.00        10
          Web Attack � XSS       0.00      0.00      0.00        10
Web Attack � Sql Injection       0.00      0.00      0.00        10
               FTP-Patator       0.00      0.00      0.00        10
               SSH-Patator       0.00      0.00      0.00        10
             DoS slowloris       0.00      0.00      0.00     30662
          DoS Slowhttptest       0.00      0.00      0.00     30959
                  DoS Hulk       0.74      0.92      0.82    103186
             DoS GoldenEye       0.02      0.26      0.04     36458
                Heartbleed       0.00      0.00      0.00     36458

                  accuracy                           0.17    607202
                 macro avg       0.08      0.08      0.06    607202
              weighted avg       0.36      0.17      0.15    607202

2025-05-12 19:07:59,245 - INFO - Epoch 2: Train Loss = 3.2004, Val F1 = 0.1457
2025-05-12 19:08:37,238 - INFO - 已更新滑动平均模型 best.pt
2025-05-12 21:00:59,196 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-12 21:00:59,196 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-12 21:00:59,196 - INFO - 训练模式: manual
2025-05-12 21:00:59,197 - INFO - 训练设备: cuda
2025-05-12 21:00:59,197 - INFO - 启用 AMP 混合精度: True
2025-05-12 21:00:59,214 - INFO - ⚙️ 动态设置 num_classes = 15
2025-05-12 21:00:59,702 - INFO - 类别权重: [0.08904721587896347, 20.128400802612305, 1.580689549446106, 1.2733337879180908, 13.323518753051758, 22.570926666259766, 22.570926666259766, 22.570926666259766, 8.623270988464355, 8.623270988464355, 5.5507965087890625, 5.5507965087890625, 0.8757878541946411, 5.5507965087890625, 5.5507965087890625]
2025-05-12 21:01:00,872 - INFO - 训练标签分布: (array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14],
      dtype=int32), array([2272625,   10054,  128027,  158930,   15189,    8966,    8966,
          8966,   23468,   23468,   36458,   36458,  231073,   36458,
         36458]))
2025-05-12 21:01:01,090 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-12 21:02:49,598 - INFO - 
                            precision    recall  f1-score   support

                    BENIGN       0.00      0.00      0.00    369389
                       Bot       0.00      0.00      0.00      3035
                      DDoS       0.00      0.00      0.00      3035
                  PortScan       0.00      0.00      0.00      3035
              Infiltration       0.00      0.00      0.00      3035
  Web Attack � Brute Force       0.00      0.00      0.00      3035
          Web Attack � XSS       0.00      0.00      0.00      3035
Web Attack � Sql Injection       0.00      0.00      0.00      3035
               FTP-Patator       0.00      0.00      0.00      3035
               SSH-Patator       0.00      0.00      0.00      3035
             DoS slowloris       0.00      0.00      0.00     30662
          DoS Slowhttptest       0.00      0.00      0.00     30959
                  DoS Hulk       0.58      0.58      0.58    103186
             DoS GoldenEye       0.07      1.00      0.13     36458
                Heartbleed       0.00      0.00      0.00     36458

                  accuracy                           0.15    634427
                 macro avg       0.04      0.11      0.05    634427
              weighted avg       0.10      0.15      0.10    634427

2025-05-12 21:02:49,607 - INFO - Epoch 1: Train Loss = 2.7773, Val F1 = 0.1021
2025-05-12 21:02:49,613 - INFO - 保存新最佳模型
2025-05-12 21:03:31,557 - INFO - 已更新滑动平均模型 best.pt
2025-05-12 21:03:31,707 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-12 21:05:24,098 - INFO - 
                            precision    recall  f1-score   support

                    BENIGN       0.00      0.00      0.00    369389
                       Bot       0.00      0.00      0.00      3035
                      DDoS       0.00      0.00      0.00      3035
                  PortScan       0.00      0.00      0.00      3035
              Infiltration       0.00      0.00      0.00      3035
  Web Attack � Brute Force       0.00      0.00      0.00      3035
          Web Attack � XSS       0.00      0.00      0.00      3035
Web Attack � Sql Injection       0.00      0.00      0.00      3035
               FTP-Patator       0.00      0.00      0.00      3035
               SSH-Patator       0.00      0.00      0.00      3035
             DoS slowloris       0.00      0.00      0.00     30662
          DoS Slowhttptest       0.00      0.00      0.00     30959
                  DoS Hulk       0.95      0.56      0.70    103186
             DoS GoldenEye       0.07      1.00      0.13     36458
                Heartbleed       0.00      0.00      0.00     36458

                  accuracy                           0.15    634427
                 macro avg       0.07      0.10      0.06    634427
              weighted avg       0.16      0.15      0.12    634427

2025-05-12 21:05:24,108 - INFO - Epoch 2: Train Loss = 3.0756, Val F1 = 0.1219
2025-05-12 21:05:24,114 - INFO - 保存新最佳模型
2025-05-12 21:06:09,255 - INFO - 已更新滑动平均模型 best.pt
2025-05-12 21:56:18,409 - INFO - 手动模式：跳过 0 个已处理文件，1 个新文件需要处理
2025-05-12 21:56:18,411 - INFO - 
====== LSTM 模型训练启动 ======
2025-05-12 21:56:18,411 - INFO - 训练模式: manual
2025-05-12 21:56:18,411 - INFO - 训练设备: cuda
2025-05-12 21:56:18,412 - INFO - 启用 AMP 混合精度: True
2025-05-12 21:56:18,484 - INFO - ⚙️ 动态设置 num_classes = 15
2025-05-12 21:56:18,926 - INFO - 类别权重: [0.09700250625610352, 5.181751728057861, 1.7572147846221924, 1.4155347347259521, 4.510786056518555, 5.245912075042725, 4.74422025680542, 4.51785135269165, 5.227384090423584, 5.035497665405273, 3.5685315132141113, 2.817913293838501, 0.9718848466873169, 6.170687675476074, 6.170687675476074]
2025-05-12 21:56:20,155 - INFO - 训练标签分布: (array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14],
      dtype=int32), array([2319228,   43416,  128027,  158930,   49874,   42885,   47420,
         49796,   43037,   44677,   63043,   79836,  231479,   36458,
         36458]))
2025-05-12 21:56:20,363 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-12 21:58:16,762 - INFO - 
                            precision    recall  f1-score   support

                    BENIGN       0.06      0.00      0.00    369389
                       Bot       0.00      0.00      0.00      3035
                      DDoS       0.00      0.00      0.00      3035
                  PortScan       0.00      0.00      0.00      3035
              Infiltration       0.00      0.00      0.00      3035
  Web Attack � Brute Force       0.00      0.00      0.00      3035
          Web Attack � XSS       0.00      0.00      0.00      3035
Web Attack � Sql Injection       0.00      0.00      0.00      3035
               FTP-Patator       0.00      0.00      0.00      3035
               SSH-Patator       0.00      0.00      0.00      3035
             DoS slowloris       0.06      1.00      0.11     30662
          DoS Slowhttptest       0.00      0.00      0.00     30959
                  DoS Hulk       0.91      0.89      0.90    103186
             DoS GoldenEye       0.00      0.00      0.00     36458
                Heartbleed       0.00      0.00      0.00     36458

                  accuracy                           0.19    634427
                 macro avg       0.07      0.13      0.07    634427
              weighted avg       0.19      0.19      0.15    634427

2025-05-12 21:58:16,773 - INFO - Epoch 1: Train Loss = 3.1399, Val F1 = 0.1513
2025-05-12 21:58:16,784 - INFO - 保存新最佳模型
2025-05-12 21:58:58,386 - INFO - 已更新滑动平均模型 best.pt
2025-05-12 21:58:58,500 - INFO - [DEBUG] 输入 shape: torch.Size([2048, 60, 32]), 是否 contiguous: True, 设备: cuda:0
2025-05-12 22:01:01,501 - INFO - 
                            precision    recall  f1-score   support

                    BENIGN       0.00      0.00      0.00    369389
                       Bot       0.00      0.00      0.00      3035
                      DDoS       0.00      0.00      0.00      3035
                  PortScan       0.00      0.00      0.00      3035
              Infiltration       0.00      0.00      0.00      3035
  Web Attack � Brute Force       0.00      0.00      0.00      3035
          Web Attack � XSS       0.00      0.00      0.00      3035
Web Attack � Sql Injection       0.00      0.00      0.00      3035
               FTP-Patator       0.00      0.00      0.00      3035
               SSH-Patator       0.01      0.99      0.02      3035
             DoS slowloris       0.00      0.00      0.00     30662
          DoS Slowhttptest       0.13      1.00      0.23     30959
                  DoS Hulk       0.00      0.00      0.00    103186
             DoS GoldenEye       0.00      0.00      0.00     36458
                Heartbleed       0.00      0.00      0.00     36458

                  accuracy                           0.05    634427
                 macro avg       0.01      0.13      0.02    634427
              weighted avg       0.01      0.05      0.01    634427

2025-05-12 22:01:01,512 - INFO - Epoch 2: Train Loss = 2.7339, Val F1 = 0.0115
